services:
  # Server test container
  server-test:
    build:
      context: .
      dockerfile: Dockerfile.server.test
    volumes:
      - ./server/src:/app/src
      - ./server/vitest.config.ts:/app/vitest.config.ts
      - ./server/tsconfig.json:/app/tsconfig.json
      - test-results:/app/test-results
    environment:
      - NODE_ENV=test
      - JWT_SECRET=test-secret
    command: npm run test:run

volumes:
  test-results:

